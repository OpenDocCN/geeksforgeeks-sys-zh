# 分布式数据库中的最终一致性与强一致性

> 原文:[https://www . geesforgeks . org/final-vs-strong 分布式数据库一致性/](https://www.geeksforgeeks.org/eventual-vs-strong-consistency-in-distributed-databases/)

**1。最终一致性:**
最终一致性是一种一致性模型，它使数据存储具有高可用性。也被称为乐观复制&是分布式系统的关键。那么，它到底是如何工作的呢？让我们借助一个用例来理解这一点。

**真实世界用例:**

*   想想一个流行的微博网站，它被部署在世界各地不同的地理区域，如亚洲、美洲、欧洲。此外，每个地理区域都有多个数据中心区:北、东、西、南。
*   此外，每个区域都有多个集群，这些集群运行多个服务器节点。因此，我们有许多分布在世界各地的数据存储节点，微博网站用它们来保存数据。因为有这么多节点在运行，所以不存在单点故障。
*   数据存储服务高度可用。即使有几个节点宕机，持久性服务仍在运行。假设一个名人在全世界每个人都开始喜欢的网站上发帖。
*   在某个时间点，日本用户喜欢帖子，这将帖子的“喜欢”计数从比如 100 增加到 101。在同一时间点，美国不同地理区域的用户点击帖子，他看到“喜欢”数为 100，而不是 101。

**上述用例的原因:**

*   很简单，因为 Post“Like”计数器的新更新值需要一些时间才能从日本移动到美国并更新在那里运行的服务器节点。虽然当时计数器的值是 101，但美国用户看到的是旧的不一致值。
*   但是当他几秒钟后刷新他的网页时，“喜欢”计数器的值显示为 101。因此，数据最初是不一致的，但最终在世界各地部署的服务器节点之间保持一致。这就是最终的一致性。

**2。强一致性:**
强一致性简单来说就是数据必须始终保持强一致性。世界上的所有服务器节点在任何时间点都应该包含与实体相同的值。实现这种行为的唯一方法是在更新时锁定节点。

**真实世界用例:**

*   让我们继续上一课中的最终一致性示例。为了确保系统的强一致性，当日本用户喜欢发布时，必须锁定不同地理区域的所有节点，以防止任何并发更新。
*   这意味着在某个时间点，只有一个用户可以更新帖子“喜欢”计数器值。因此，一旦日本用户将“喜欢”计数器从 100 更新为 101。该值在所有节点上全局复制。一旦所有节点达成一致，锁就会被解除。现在，其他用户也可以发帖了。
*   如果节点需要一段时间才能达成共识，他们必须等到那时。嗯，这在社交应用中肯定是不可取的。但是想想股票市场应用程序，其中用户在某个时间点看到同一只股票的不同价格，并同时更新它。这会造成混乱。因此，为了避免这种混乱，我们需要我们的系统是强一致的。
*   必须锁定节点以进行更新。对所有请求进行排队是使系统高度一致的一种好方法。强一致性模型提高了系统的高可用性和执行并发更新的能力。这就是 ACID 事务实现的强一致性。

**ACID 交易支持:**

像 [NoSQL 数据库](https://www.geeksforgeeks.org/introduction-to-nosql/)这样的动态水平扩展的分布式系统不支持 [ACID 事务](https://www.geeksforgeeks.org/acid-properties-in-dbms/)全球&这是由于它们的设计。NoSQL 技术发展的全部原因是高可用性和可扩展性的能力。如果每次都要锁定节点，那就变得跟 SQL 一样了。因此，NoSQL 数据库不支持 ACID 交易，而那些声称支持 ACID 交易的数据库则适用于这些交易。通常，事务支持仅限于地理区域或实体层次结构。技术开发人员确保所有高度一致的实体节点都位于同一地理区域，以使 ACID 交易成为可能。

**结论:**
对于事务性事务，选择 MySQL，因为它提供了锁定功能，支持 ACID 事务。