# 数据库管理系统中的数据库恢复技术

> 原文:[https://www . geesforgeks . org/database-recovery-technologies-in-DBMS/](https://www.geeksforgeeks.org/database-recovery-techniques-in-dbms/)

**数据库系统**像任何其他计算机系统一样，会出现故障，但存储在其中的数据必须在需要时可用。当数据库出现故障时，它必须具备快速恢复的能力。它还必须具有原子性，即要么事务成功完成并提交(其影响永久记录在数据库中)，要么事务对数据库没有影响。

两者都有自动和非自动方式，备份数据和从任何故障情况中恢复。用于恢复因系统崩溃、事务错误、病毒、灾难性故障、不正确的命令执行等而丢失的数据的技术。是数据库恢复技术。因此，为了防止数据丢失，可以使用基于延迟更新和立即更新或备份数据的恢复技术。

恢复技术在很大程度上依赖于一个称为**系统日志**的特殊文件的存在。它包含关于每个交易的开始和结束的信息以及在**交易**中发生的任何更新。该日志跟踪影响数据库项目值的所有事务操作。从事务失败中恢复需要这些信息。

*   日志保存在磁盘 start_transaction(T)上:该日志条目记录事务 T 开始执行。
*   read_item(T，X):该日志条目记录事务 T 读取数据库项 X 的值
*   write_item(T，X，old_value，new_value):该日志条目记录事务 T 将数据库项 X 的值从 old_value 更改为 new_value。旧值有时被称为 X 的前像，新值被称为 X 的后像。
*   commit(T):该日志条目记录了事务 T 已经成功完成了对数据库的所有访问，其效果可以提交(永久记录)到数据库。
*   中止(T):这记录事务 T 已经被中止。
*   检查点:检查点是一种机制，所有以前的日志都将从系统中删除，并永久存储在存储磁盘中。检查点声明了一个点，在该点之前，数据库管理系统处于一致状态，并且所有事务都已提交。

当事务 T 访问数据库的所有操作都已成功执行时，事务 T 到达其**提交**点，即事务到达不会**中止**的点(未完成即终止)。一旦提交，事务将永久记录在数据库中。提交总是涉及将提交条目写入日志并将日志写入磁盘。在系统崩溃时，在日志中搜索项目，寻找已经在日志中写入 start_transaction(T)条目但还没有写入 commit(T)条目的所有事务 T；在恢复过程中，这些事务可能必须回滚，以撤消它们对数据库的影响

*   **撤销–**如果事务崩溃，则恢复管理器可以撤销事务，即撤销事务的操作。这包括检查日志条目 write_item(T，x，old_value，new_value)的事务，并将数据库中 item x 的值设置为 old-value。从非灾难性事务故障中恢复有两种主要技术:延迟更新和立即更新。
*   **延迟更新–**该技术在事务到达提交点之前不会物理更新磁盘上的数据库。在提交之前，所有事务更新都记录在本地事务工作区中。如果事务在到达提交点之前失败，它不会以任何方式更改数据库，因此不需要撤销。可能有必要重做记录在本地事务工作区中的操作的效果，因为它们的效果可能尚未写入数据库。因此，延迟更新也被称为**不撤销/重做算法**
*   **即时更新–**在即时更新中，数据库可能会在事务到达提交点之前被事务的某些操作更新。但是，这些操作在应用到数据库之前会记录在磁盘上的日志中，因此恢复仍然是可能的。如果事务未能达到其提交点，其操作的效果必须撤销，即事务必须回滚，因此我们需要撤销和重做。这种技术被称为**撤销/重做算法。**
*   **缓存/缓冲–**在这种情况下，包含要更新的数据项的一个或多个磁盘页面被缓存到主内存缓冲区中，然后在写入磁盘之前在内存中更新。称为数据库管理系统缓存的内存缓冲区集合由数据库管理系统控制，用于保存这些缓冲区。目录用于跟踪缓冲区中的数据库项目。每个缓冲区都有一个脏位，如果缓冲区未被修改，则为 0，如果被修改，则为 1。
*   **影子分页–**它提供原子性和持久性。构建了一个包含 n 个条目的目录，其中第 I 个条目指向链接上的第 I 个数据库页面。当事务开始执行时，当前目录被复制到一个影子目录中。当要修改页面时，会分配一个进行更改的影子页面，当它准备好变得持久时，所有引用原始页面的页面都会更新为引用新的替换页面。

一些备份技术如下:

*   **完整数据库备份–**在这个包含数据和数据库的完整数据库中，还原整个数据库所需的 Meta 信息(包括全文目录)会按照预定义的时间序列进行备份。
*   **差异备份–**它只存储自上次完整数据库备份以来发生的数据更改。如果自上次完整数据库备份以来，相同的数据发生了多次更改，差异备份会存储更改数据的最新版本。首先，我们需要恢复完整的数据库备份。
*   **事务日志备份–**在这种情况下，数据库中发生的所有事件，就像执行的每一条语句的记录一样，都会被备份。它是事务日志条目的备份，包含数据库中发生的所有事务。通过这种方式，数据库可以恢复到特定的时间点。如果数据文件被销毁，甚至没有一个提交的事务丢失，甚至可以从事务日志中执行备份。

**参考–**
[备份和恢复–](https://www.cs.uct.ac.za/mit_notes/database/htmls/chp14.html)cs.uct.ac.za/mit_notes

本文由 [**【喜马拉雅】**](https://auth.geeksforgeeks.org/profile.php?user=Himanshi_Singh) 供稿。如果你喜欢 GeeksforGeeks 并想投稿，你也可以使用[contribute.geeksforgeeks.org](http://www.contribute.geeksforgeeks.org)写一篇文章或者把你的文章邮寄到 contribute@geeksforgeeks.org。看到你的文章出现在极客博客主页上，帮助其他极客。

如果你发现任何不正确的地方，或者你想分享更多关于上面讨论的话题的信息，请写评论。