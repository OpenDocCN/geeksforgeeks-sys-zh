# 包装概念和 TCP 序列号

> 原文:[https://www . geesforgeks . org/回绕概念和 tcp 序列号/](https://www.geeksforgeeks.org/wrap-around-concept-and-tcp-sequence-number/)

先决条件–[TCP |服务和段结构](https://www.geeksforgeeks.org/tcp-services-and-segment-structure/)
传输控制协议(TCP)是互联网协议中最重要的协议之一。它为应用程序提供完整的传输层服务，并在发送方和接收方之间生成一个在传输期间处于活动状态的虚拟电路。它的数据段由一个 TCP 报头、TCP 选项和数据段传输的数据组成。

**序列号–**
32 位序列号字段定义分配给该段中包含的第一个数据字节的编号。TCP 是一种流传输协议。为了确保连通性，要传输的每个字节都要编号。在连接建立期间，每一方使用随机数生成器来创建初始序列号(ISN)，该序列号在每个方向上通常是不同的。我们知道一个 TCP 序列号是 32 位。所以它是有限的(从 0 到(2<sup>32</sup>-1)= 4GB 的序列号)，这意味着我们只能发送 4GB 的数据，唯一的序列号不能超过这个数字。它有助于分配一个不与通过 TCP 连接传输的其他数据字节冲突的序列号。ISN 对于每个连接都是唯一的，并且由每个设备分开。

**回绕概念–**
这可能会以很高的流量发生，所有的序列号都用完了。每个数据包的序列号必须是唯一的，但由于它在某个时间点是有限的(4gb)，序列号会被完全消耗掉。使用过的序列号，如果可用，可以按照要求再次使用，这种序列号的重复使用被称为**环绕概念**。

简而言之，“一旦所有的序列号都用完了，就一次又一次地使用它们，以保持数据传输的连续性”被称为环绕概念。这有助于发送越来越多的数据，而不用担心要发送多少数据。由于序列号可以反复使用，因此对数据量没有限制。

**何时以及如何实现回绕？**
例如，如果我正在下载 4GB+ 2 字节大小的软件，但是可用的序列号只有 4GB，那么剩下的两个字节将不会得到任何序列号。在这种情况下，序列号被包装起来，也就是说，它们根据需求被一次又一次地使用。这种包装受到随机初始序列号的影响。我们可能在开始时得到较少的序列号，但是在所有序列号再次被使用后，序列号将从 0 开始。

无论我们从哪里开始使用序列号，我们都会得到 2 <sup>32</sup> 序列号。因此，我们可以说，根据需求重用序列号是 TCP 序列号的包装概念。现在，如果我们有一个包装的概念，那么一个新的概念来了，即*包装时间*，这取决于包装序列号。

**回绕时间–**
回绕所花费的时间称为回绕时间。这意味着如果我们从序列号 0 开始(或者它可以是任何东西)，在多长时间之后，我们将再次使用这个相同的序列号。回绕时间是开始重用相同序列号所花费的时间，也可以说重复序列号所花费的时间是符合要求的。回绕时间取决于序列号和带宽。因为带宽是消耗比特(序列号)的比特速率。消耗速度越快，序列号消耗越快。

```
Wrap Around Time
= (Total sequence number) / (Bandwidth)
= (232) / (Bandwidth) 
```

**为什么“环绕”是可能的？**
有一个概念被称为**生命时间**，在最坏的情况下，一个数据包将需要 3 分钟(180 秒)才能到达目的地(即数据包的生命周期)。在今天的技术中，相同的序列号将在 180 秒后可用，但我们不打算在回绕时间之前使用它。只要一包的*回绕时间>生命时间*使用相同的序列号就没有问题。在回绕时间之后，数据段的生命周期结束，这意味着在这段时间内会发生超时。在所有序列号都被使用并且它们的寿命结束后，再次使用相同的序列号没有害处。

**减少绕回时间–**
如果要消耗的总位数等于序列号，则无需绕回序列号。但这是不可能的，我们将使用回绕概念。因为回绕时间直接取决于序列号的数量，而反过来取决于带宽(数据流动的速率)。

序列号越多，回绕时间越长。带宽越小，回绕时间越长。所以为了减少回绕时间，我们需要:

1.  减少序号或

2.  增加带宽(可能的话)

**示例-1:** 给定 n 位，可能有多少个序列号？
**解释–**
1 位可能有 2 个数字，即 0 和 1
2 位可能有 4 个数字，即 00、01、10、11
3 位可能有 8 个数字，即 000、001、010、011、100、101、110、111..以此类推
对于 n 位，2^n 数是可能的，即从 0 到 2 <sup>n</sup> -1(二进制)。

**示例-2:** 给定 n 个序列号，需要多少位来表示集合？
T3】解释–T5】让我们需要 x 个位数，我们知道 2 <sup>x</sup> = n

```
=> x log(2) = log(n) 
```

我们会有，

```
=> x = log(n) 
```

取给定日志的基数 2。

**例-3:** 信道带宽为 1 GBps。一个数据包在链路中能停留多长时间而不用担心有 2 个序列号相同的数据包的问题？
T3】解释–T5】

```
Bandwidth = 1 GBps = 230 
Sequence numbers = 232

So, Wrap around time: 
= Sequence number/Bandwidth
=232 / 230
=22
=4 seconds 
```

**例-4:** [GATE-CS-2014-(集-3) |问题 65](https://www.geeksforgeeks.org/gate-gate-cs-2014-set-3-question-37/)

**示例-5:** [GATE CS 2018 |问题 32](https://www.geeksforgeeks.org/gate-gate-cs-2018-question-32/)