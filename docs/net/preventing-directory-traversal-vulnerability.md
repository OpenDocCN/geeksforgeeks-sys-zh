# 防止目录遍历漏洞

> 原文:[https://www . geesforgeks . org/proving-directory-遍历-漏洞/](https://www.geeksforgeeks.org/preventing-directory-traversal-vulnerability/)

目录遍历是一个漏洞，允许攻击者访问根目录之外或该 web 服务器主目录之外的文件。根目录有一些用户无法访问的内部文件。该漏洞可以在 web 服务器或 web 应用程序代码中找到。这种类型的攻击也被称为*路径遍历攻击*。

通过测试网站中接受用户输入、HTTP 请求、表单和 cookies 的所有部分，可以发现目录遍历漏洞。攻击者使用带有两个点的 cd 命令(cd..)将其更改为其父目录。通过添加../直接指向 URL 中的文件路径，我们可以尝试将其更改为更高的目录来查看系统文件。

攻击者可以访问的一些系统文件:

**对于基于 Unix 的操作系统:**

*   **/etc/passwd 文件:**包含所有用户账户的信息
*   **/etc/group 文件:**包含用户所属的组
*   **/etc/profile 文件:**包含用户的默认变量
*   **/proc/self/environ 文件:**包含某些环境变量
*   **/etc/发行文件:**包含登录前要显示的消息
*   **/proc/版本文件:**包含正在使用的 Linux 内核版本
*   **/proc/cpuinfo 文件:**包含处理器信息

**对于 Windows 操作系统:**

*   c:\ Windows \修复\系统
*   c:\ Windows \修复\SAM
*   C:\Windows\win.ini
*   C：\boot.ini
*   c:\ Windows \ system32 \ config \ AppEvent。等粘温度

**目录遍历攻击示例:**
易受攻击的 PHP 代码的典型示例是:

## 服务器端编程语言（Professional Hypertext Preprocessor 的缩写）

```
<?php

    $file = $_GET['page']; //The page we want to display 

?>
```

下面给出了一个网址，它有一个包含函数作为 GET 方法请求

```
http://192.168.29.23/dvwa/vulnerabilities/fi/?page=include.php
```

使用目录遍历攻击，攻击者可以追加../直接指向 URL 中的文件路径

```
http://192.168.29.23/dvwa/vulnerabilities/fi/?page=../../../../../../etc/passwd
```

**防止目录遍历攻击:**

*   为了防止目录遍历在您的网络服务器，始终保持您的网络服务器和操作系统更新。
*   网站应该在处理用户输入之前对其进行验证，以防止目录遍历攻击。
*   授予非超级用户的权限对于其需要运行的文件应该是只读的。不应该允许非超级用户写入或修改任何文件。
*   当对目录或文件进行任何 URL 请求时，请规范化所有字符。例如，所有%20 都应转换为空格。
*   请始终从独立于系统磁盘的磁盘上运行 web 服务器，因为系统磁盘上有敏感信息。
*   如果需要从用户处获取文件名，请确保通过有效字符对其进行了正确扫描。