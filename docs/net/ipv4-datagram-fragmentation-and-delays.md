# IPv4 数据报分段和延迟

> 原文:[https://www . geesforgeks . org/IP v4-数据报-分段和延迟/](https://www.geeksforgeeks.org/ipv4-datagram-fragmentation-and-delays/)

**为什么需要 IPv4 数据报分片？**
不同的网络可能有不同的最大传输单元(MTU)，例如由于局域网技术的差异。当一个网络想要向 MTU 较小的网络传输数据报时，路径上的路由器可能会对数据报进行分段和重组。

**碎片化是如何完成的？**
当路由器收到数据包时，会检查目的地址并确定 MTU。如果数据包的大小大于 MTU，并且报头中的“不分段(DF)”位设置为 0，则数据包将被分段并逐个发送。每个片段的最大大小是 MTU 减去 IP 头大小(最小 20 字节，最大 60 字节)。

每个片段都被转换成一个数据包，数据报报头会发生以下变化:

1.  总长度字段将更改为片段的大小。
2.  除最后一个片段包外，所有片段包都设置了更多片段位。
3.  片段偏移量字段是根据正在设置的片段数量和 MTU 来设置的。
4.  重新计算报头校验和。

**示例:**对于 4000 字节的数据包和 1500 字节的 MTU，我们有 3980 字节的实际数据要传输，1480 字节是允许发送的最大数据大小。因此，将有 3 个片段:
对于第一个片段，数据大小= 1480 字节，偏移量= 0，MF 标志= 1
对于第二个片段，数据大小= 1480 字节，偏移量= 1480，MF 标志= 1
对于第三个片段，数据大小= 1020 字节，偏移量= 2960，MF 标志= 0

这里需要注意的重要一点是，所有片段将具有相同的标识号，从而指示所有片段属于相同的父数据包。

**延迟–**
处理延迟:路由器处理数据包报头所花费的时间。

排队延迟:数据包在路由队列中花费的时间。

传输延迟:将数据包加载到传输信道上所花费的时间
D <sub>t</sub> = N/R，
N:要传输的位数
R:信道的速率或传输速度

传播延迟–数据包从源到达目的地所需的时间

D <sub>p</sub> = D/S，
D:源与目的地之间的距离
S:为传播速度

上一次 GATE 考试已经就以上题目提出了以下问题。

1.  [GATE CS 2012 |第 42 题](https://www.geeksforgeeks.org/gate-gate-cs-2012-question-44/)
2.  [GATE-CS-2013 |第 65 题](https://www.geeksforgeeks.org/gate-gate-cs-2013-question-37/)
3.  [GATE-CS-2014 第 3 集|第 65 题](https://www.geeksforgeeks.org/gate-gate-cs-2014-set-3-question-38/)

如果您发现任何不正确的地方，或者您想分享更多关于上面讨论的主题的信息，请写评论