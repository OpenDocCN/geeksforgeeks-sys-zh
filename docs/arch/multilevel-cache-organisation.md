# 多级缓存组织

> 原文:[https://www . geesforgeks . org/multiple-cache-organization/](https://www.geeksforgeeks.org/multilevel-cache-organisation/)

[**Cache**](https://www.geeksforgeeks.org/cache-memory/) 是一种随机访问内存，由 CPU 使用，以减少访问内存的平均时间。
**多级缓存**是通过减少*【未命中惩罚】*来提高缓存性能的技术之一。未命中惩罚是指每当高速缓存中出现 ***【未命中】*** 时，将数据从主存储器带入高速缓存所需的额外时间。
为了清楚理解，让我们考虑一个例子，其中 CPU 需要 10 个内存引用来访问所需的信息，并在系统设计的以下 3 种情况下考虑这种情况:

**<u>案例 1:无缓存的系统设计</u>**

![](img/a085db56ec2a6d2b2d24848f3282d94b.png)

这里，中央处理器直接与主存储器通信，不涉及缓存。
在这种情况下，CPU 需要访问主存储器 10 次才能访问到想要的信息。

**<u>案例二:带缓存的系统设计</u>**

![](img/d62fbed0e68d0e58d327fad5b7b402f1.png)

这里，中央处理器首先检查高速缓冲存储器中是否存在期望的数据，即高速缓冲存储器中是否存在 ***【命中】*** 或 ***【未命中】*** 。假设高速缓冲存储器中有 *3* 未命中，那么主存储器将只被访问 3 次。我们可以看到，这里的未命中惩罚减少了，因为主存储器被访问的次数比前面的情况少。

**<u>案例三:多级缓存的系统设计</u>**

![](img/c2eab6a5798662cde3a00b73e6452a27.png)

这里，通过引入多级缓存，进一步优化了缓存性能。如上图所示，我们正在考虑二级缓存设计。假设在 L1 高速缓冲存储器中有 *3 次未命中*，而在这 3 次未命中中，在 L2 高速缓冲存储器中有 *2 次未命中*，那么主存储器将仅被访问 2 次。很明显，这里的未命中惩罚比前面的情况大大减少，从而提高了高速缓存的性能。

**<u>注:</u>**
从以上 3 种情况我们可以观察到，我们正在尝试减少主内存引用的数量，从而减少未命中惩罚，以提高整体系统性能。此外，需要注意的是，在多级高速缓存设计中，一级高速缓存连接到中央处理器，虽然体积小但速度快。虽然，L2 缓存连接到主缓存，即一级缓存，但它的大小更大，速度更慢，但仍然比主内存快。

```
Effective Access Time = Hit rate * Cache access time
                      + Miss rate * Lower level access time

```

**多级缓存的平均访问时间:(T <sub>平均值</sub> )**

t<sub>avg</sub>= H<sub>1</sub>* C<sub>1</sub>+(1–H<sub>1</sub>)*(H<sub>2</sub>* C<sub>2</sub>+(1–H<sub>2</sub>)* M)

其中
H1 是 L1 缓存中的命中率。
H2 是 L2 缓存中的命中率。
C1 是获取 L1 缓存信息的时候了。
C2 是将信息从 L2 缓存传输到 L1 缓存的“未命中”惩罚。
M 是将信息从主内存传输到 L2 缓存的 Miss 惩罚。

**示例:**
求处理器的平均内存访问时间，时钟周期时间为 2 ns，每条指令的未命中率为 0.04，未命中惩罚为 25 个时钟周期，缓存访问时间(包括命中检测)为 1 个时钟周期。此外，假设读取和写入未命中惩罚相同，并忽略其他写入停顿。

**解决方案:**

平均内存访问时间(AMAT)=命中时间+未命中率*未命中惩罚。

命中时间= 1 个时钟周期(命中时间=命中率*访问时间)但是这里直接给出了命中时间，

失败率= 0.04

未命中惩罚= 25 个时钟周期(这是命中后上述级别的内存所花费的时间)

所以，AMAT= 1 + 0.04 * 25
AMAT= 2 个时钟周期

根据问题 1，时钟周期= 2 ns

AMAT = 4ns