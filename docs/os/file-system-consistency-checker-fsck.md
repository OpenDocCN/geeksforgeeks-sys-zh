# 文件系统一致性检查器(FSCK)

> 原文:[https://www . geesforgeks . org/file-system-consistency-checker-fsck/](https://www.geeksforgeeks.org/file-system-consistency-checker-fsck/)

文件系统不一致是操作系统中的一个主要问题。FSCK 是采用的标准解决方案之一。

**文件系统一致性检查器(FSCK):**
FSCK 是一种仍然被基于 Linux 的旧系统用来发现和修复不一致的方法。这不是一个完整的解决方案，可能仍然有指向垃圾数据的信息节点。主要重点是使**元数据**内部一致。

以下是 FSCK 为实现一致性而执行的检查:

*   **超级块检查:**
    FSCK 执行健全性检查，查看文件大小是否大于分配的块数。在这种情况下，它会尝试找到可疑的超级块，并改用备用副本。
*   **空闲块检查:**
    FSCK 还会扫描索引节点，以确保索引节点中的块被标记为已分配。
*   **索引节点状态检查:**
    FSCK 检查索引节点是否损坏。损坏的信息节点被简单地清除。
*   **索引节点链接检查:**
    FSCK 计算到一个索引节点的链接数，并修改索引节点数。如果分配的信息节点没有引用它的目录或文件，FSCK 会将其移动到丢失和找到的目录。
*   **重复指针:**
    FSCK 检查重复指针。例如，如果两个信息节点具有指向同一数据块的指针，则可以删除其中一个信息节点。
*   **坏块:**
    坏指针就是指向超出范围的内存地址的指针。在这种情况下，FSCK 删除指针。
*   **目录检查:**
    FSCK 确保目录格式正确，例如，它们应该以“.”开头和“..”。

**FSCK 优势:**

*   它几乎不需要额外的空间。

**FSCK 的劣势:**

*   一次又一次地扫描磁盘速度很慢，对于大磁盘来说不可行。
*   它需要对文件系统有深入的了解和先验知识。随着文件系统的不断发展，很难跟踪每一个细微差别。

**Linux 中的 fsck 命令:**
Linux 中的 fsck 命令允许我们手动检查文件系统的不一致性。下面是该命令的示例用法。

```
sudo fsck /dev/sda2
```

上面的命令只是检查装载到/dev/sda2 分区上的文件系统。如果文件系统可能有一些不一致，fsck 会提示我们可能的操作。

```
fsck.fat 4.1 (2017-01-24) 
```

0x41:脏位置 1。文件系统未正确卸载，某些数据可能已损坏:删除脏位，不采取任何措施。