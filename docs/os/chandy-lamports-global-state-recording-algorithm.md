# Chandy–Lamport 的全局状态记录算法

> 原文:[https://www . geesforgeks . org/chandy-lamports-global-state-recording-algorithm/](https://www.geeksforgeeks.org/chandy-lamports-global-state-recording-algorithm/)

每个分布式系统都有许多运行在不同物理服务器上的进程。这些进程通过使用文本消息的通信通道相互通信。这些进程既没有共享内存，也没有公共物理时钟，这使得确定瞬时全局状态的过程变得困难。

一个进程可以在给定的时间记录它自己的本地状态，但是传输中的消息(在它要被传递的途中)将不包括在记录的状态中，因此在传输中的消息被传递之后，系统的实际状态将是不正确的。

**昌迪**和**兰伯特**是第一个提出捕捉分布式系统一致全局状态的算法的人。所提出算法背后的主要思想是，如果我们知道一个进程发送的所有消息已经被另一个进程接收，那么我们就可以记录系统的全局状态。

分布式系统中的任何进程都可以使用名为 **MARKER** 的特殊消息来启动这个全局状态记录算法。这个标记跨越所有通信信道遍历分布式系统，并使每个进程记录它自己的状态。最后记录整个系统的状态(全局状态)。该算法不干扰进程的正常执行。

**算法假设:**

*   分布式系统中有有限数量的进程，它们不共享内存和时钟。
*   存在有限数量的通信信道，并且它们是单向的和先进先出排序的。
*   系统中任何两个进程之间都存在一条通信路径
*   在信道上，消息的接收顺序与发送顺序相同。

**算法:**

*   **流程的标记发送规则 *P* :**
    *   进程 **p** 记录自己的本地状态
    *   对于来自过程 **P** 的每个输出通道 **C** ，在沿着 **C** 发送任何其他消息之前， **P** 沿着 **C** 发送标记。
        ( **注意:**进程 Q 将在他的传入通道 C1 上收到此标记。)
*   **流程的标记接收规则 *Q* :**
    *   如果过程 **Q** 还没有记录它自己的本地状态，那么
        *   将传入通道 C1 的状态记录为空序列或 null。
        *   记录来话通道 C1 的状态后，流程 **Q** 遵循标记发送规则
    *   如果过程 **Q** 已经记录了它的状态
        *   记录传入通道 **C1** 的状态，作为在记录了 **Q** 的状态之后并且在 **Q** 从进程 p 接收到沿 C1 的标记之前沿 C1 通道接收到的消息序列

**需要拍摄快照或记录系统全局状态:**

*   **检查点:**有助于创建检查点。如果应用程序出现故障，这个检查点可以重用
*   **垃圾回收:**可以用来移除没有任何引用的对象。
*   它可以用于死锁和终止检测。
*   对其他调试也有帮助。